"use strict";(globalThis.webpackChunkwave_lang=globalThis.webpackChunkwave_lang||[]).push([[545],{4395(e,n,a){a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"syntax/ffi","title":"FFI","description":"Este documento explica las especificaciones de la FFI (Interfaz de Funci\xf3n Externa) para llamar a funciones implementadas externamente en el lenguaje Wave.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/syntax/ffi.md","sourceDirName":"syntax","slug":"/syntax/ffi","permalink":"/es/docs/syntax/ffi","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"\uc5f4\uac70\ud615 (enum)\uacfc \ud0c0\uc785 \ubcc4\uce6d (type alias)","permalink":"/es/docs/syntax/enumandtype"},"next":{"title":"Ecosistema Wave","permalink":"/es/docs/ecosystem/"}}');var s=a(4848),l=a(8453);const c={sidebar_position:9},r="FFI",d={},o=[{value:"Resumen",id:"resumen",level:2},{value:"Declaraci\xf3n extern",id:"declaraci\xf3n-extern",level:2},{value:"Especificaci\xf3n de ABI",id:"especificaci\xf3n-de-abi",level:2},{value:"Declaraci\xf3n extern a nivel de funci\xf3n",id:"declaraci\xf3n-extern-a-nivel-de-funci\xf3n",level:2},{value:"Declaraci\xf3n extern a nivel de bloque",id:"declaraci\xf3n-extern-a-nivel-de-bloque",level:2},{value:"Especificaci\xf3n del nombre del s\xedmbolo",id:"especificaci\xf3n-del-nombre-del-s\xedmbolo",level:2},{value:"Especificaci\xf3n de s\xedmbolos a nivel de funci\xf3n",id:"especificaci\xf3n-de-s\xedmbolos-a-nivel-de-funci\xf3n",level:3},{value:"Especificaci\xf3n de s\xedmbolos a nivel de bloque",id:"especificaci\xf3n-de-s\xedmbolos-a-nivel-de-bloque",level:3},{value:"Tipo puntero",id:"tipo-puntero",level:2},{value:"Uso de estructuras",id:"uso-de-estructuras",level:2},{value:"Llamada a funciones externas",id:"llamada-a-funciones-externas",level:2},{value:"Enlazado",id:"enlazado",level:2},{value:"Limitaciones",id:"limitaciones",level:2}];function t(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ffi",children:"FFI"})}),"\n",(0,s.jsx)(n.p,{children:"Este documento explica las especificaciones de la FFI (Interfaz de Funci\xf3n Externa) para llamar a funciones implementadas externamente en el lenguaje Wave.\nA trav\xe9s de la FFI, los programas de Wave pueden integrarse directamente con bibliotecas nativas escritas en otros lenguajes."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"resumen",children:"Resumen"}),"\n",(0,s.jsx)(n.p,{children:"La FFI de Wave opera basada en declaraciones.\nLas funciones externas no se implementan en el c\xf3digo Wave, solo se especifica qu\xe9 ABI (Interfaz Binaria de Aplicaci\xf3n) siguen.\nLa implementaci\xf3n real se resuelve en la etapa de enlace desde bibliotecas externas."}),"\n",(0,s.jsx)(n.p,{children:"La FFI declara \xfanicamente la existencia de la funci\xf3n en tiempo de compilaci\xf3n, y el enlazador conecta los s\xedmbolos reales al crear el ejecutable."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"declaraci\xf3n-extern",children:"Declaraci\xf3n extern"}),"\n",(0,s.jsx)(n.p,{children:"Las funciones externas se declaran utilizando la palabra clave extern.\nTodas las declaraciones de funciones externas requieren especificar un ABI."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:"extern(abi) fun nombrefunci\xf3n(argumentos...) -> tipoderetorno;\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"especificaci\xf3n-de-abi",children:"Especificaci\xf3n de ABI"}),"\n",(0,s.jsxs)(n.p,{children:["Debe especificarse expresamente un ABI en las declaraciones ",(0,s.jsx)(n.code,{children:"extern"}),".\nEl ABI indica qu\xe9 convenci\xf3n de llamada y reglas de s\xedmbolo sigue la funci\xf3n externa."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:"extern(c) fun printf(fmt: ptr<u8>);\nextern(rust) fun rust_func(i32);\n"})}),"\n",(0,s.jsx)(n.p,{children:"El ABI se trata como un identificador y no se proporcionan valores predeterminados para ABIs espec\xedficos a nivel de lenguaje.\nTodas las funciones externas deben especificar un ABI expresamente."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"declaraci\xf3n-extern-a-nivel-de-funci\xf3n",children:"Declaraci\xf3n extern a nivel de funci\xf3n"}),"\n",(0,s.jsx)(n.p,{children:"Para declarar una sola funci\xf3n externa, se escribe de la siguiente manera."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:"extern(c) fun InitWindow(width: i32, height: i32, title: ptr<u8>);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Esta declaraci\xf3n significa que el s\xedmbolo ",(0,s.jsx)(n.code,{children:"InitWindow"})," siguiendo el ABI de C existe en una biblioteca externa."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"declaraci\xf3n-extern-a-nivel-de-bloque",children:"Declaraci\xf3n extern a nivel de bloque"}),"\n",(0,s.jsx)(n.p,{children:"Si hay varias funciones externas que usan el mismo ABI, se pueden declarar en forma de bloque."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:"extern(c) {\n    fun InitWindow(width: i32, height: i32, title: ptr<u8>);\n    fun CloseWindow();\n    fun BeginDrawing();\n    fun EndDrawing();\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"La declaraci\xf3n a nivel de bloque es sem\xe1nticamente id\xe9ntica a la declaraci\xf3n a nivel de funci\xf3n, y es simplemente una sintaxis para mejorar la legibilidad y estructuraci\xf3n."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"especificaci\xf3n-del-nombre-del-s\xedmbolo",children:"Especificaci\xf3n del nombre del s\xedmbolo"}),"\n",(0,s.jsx)(n.p,{children:"En algunos ABI, el nombre de la funci\xf3n Wave puede no coincidir con el nombre del s\xedmbolo del enlazador real.\nEn este caso, se puede especificar el nombre real del s\xedmbolo al que se enlazar\xe1 la funci\xf3n externa como una cadena de texto."}),"\n",(0,s.jsx)(n.h3,{id:"especificaci\xf3n-de-s\xedmbolos-a-nivel-de-funci\xf3n",children:"Especificaci\xf3n de s\xedmbolos a nivel de funci\xf3n"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:'extern(rust, "_ZN4test10rust_func117h123abcE")\nfun rust_func(i32);\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Esta declaraci\xf3n especifica que al llamar a ",(0,s.jsx)(n.code,{children:"rust_func"})," se deber\xeda usar el s\xedmbolo ",(0,s.jsx)(n.code,{children:"_ZN4test10rust_func117h123abcE"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"especificaci\xf3n-de-s\xedmbolos-a-nivel-de-bloque",children:"Especificaci\xf3n de s\xedmbolos a nivel de bloque"}),"\n",(0,s.jsx)(n.p,{children:"En la declaraci\xf3n a nivel de bloque, se puede especificar el nombre del s\xedmbolo individualmente despu\xe9s de cada funci\xf3n."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:'extern(rust) {\n    fun rust_func1(i32) "_ZN4test10rust_func117h123abcE";\n    fun rust_func2(i32) "_ZN4test10rust_func217h456defE";\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"tipo-puntero",children:"Tipo puntero"}),"\n",(0,s.jsxs)(n.p,{children:["El puntero se expresa en la forma ",(0,s.jsx)(n.code,{children:"ptr<T>"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:"ptr<u8>\nptr<MyStruct>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ptr<T>"})," corresponde directamente con un puntero del lenguaje externo y Wave no gestiona la propiedad de memoria o el ciclo de vida."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"uso-de-estructuras",children:"Uso de estructuras"}),"\n",(0,s.jsx)(n.p,{children:"Las estructuras se pueden utilizar como argumento o valor de retorno de una funci\xf3n externa."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:"struct Color {\n    r: u8,\n    g: u8,\n    b: u8,\n    a: u8,\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Cuando se usa una estructura en FFI, el orden de los campos se mantiene como se declar\xf3 y sigue el layout de memoria requerido por el ABI."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"llamada-a-funciones-externas",children:"Llamada a funciones externas"}),"\n",(0,s.jsxs)(n.p,{children:["Las funciones declaradas con ",(0,s.jsx)(n.code,{children:"extern"})," se llaman de la misma manera que las funciones normales."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-wave",children:'fun main() -> i32 {\n    InitWindow(800, 600, "Wave");\n    BeginDrawing();\n    EndDrawing();\n    CloseWindow();\n    return 0;\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"No hay diferencias gramaticales en la llamada, y el convenio de la llamada y conexi\xf3n de s\xedmbolos es manejado completamente por el ABI y el enlazador."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"enlazado",children:"Enlazado"}),"\n",(0,s.jsx)(n.p,{children:"La implementaci\xf3n real de una funci\xf3n externa se proporciona desde bibliotecas externas en la etapa de enlace.\nEl compilador de Wave genera un archivo objeto que incluye llamadas a funciones externas, y el enlazador resuelve los s\xedmbolos a trav\xe9s de las bibliotecas especificadas."}),"\n",(0,s.jsx)(n.p,{children:"La especificaci\xf3n de bibliotecas se realiza a trav\xe9s de herramientas de compilaci\xf3n y opciones de CLI."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"limitaciones",children:"Limitaciones"}),"\n",(0,s.jsx)(n.p,{children:"Wave no proporciona las siguientes caracter\xedsticas."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Puntero a funci\xf3n"}),"\n",(0,s.jsx)(n.li,{children:"Funciones de callback"}),"\n",(0,s.jsx)(n.li,{children:"Gesti\xf3n autom\xe1tica de memoria"}),"\n",(0,s.jsx)(n.li,{children:"Gesti\xf3n integrada de excepciones entre lenguajes"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Estas caracter\xedsticas pueden ser tratadas por separado en versiones futuras."})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453(e,n,a){a.d(n,{R:()=>c,x:()=>r});var i=a(6540);const s={},l=i.createContext(s);function c(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);