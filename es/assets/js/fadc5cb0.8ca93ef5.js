"use strict";(globalThis.webpackChunkwave_lang=globalThis.webpackChunkwave_lang||[]).push([[905],{7360(e,a,n){n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"syntax/inline_asm","title":"Ensambliado en l\xednea","description":"Introducci\xf3n","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/syntax/inline_asm.md","sourceDirName":"syntax","slug":"/syntax/inline_asm","permalink":"/es/docs/syntax/inline_asm","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Puntero","permalink":"/es/docs/syntax/pointer"},"next":{"title":"Estructura","permalink":"/es/docs/syntax/struct"}}');var r=n(4848),s=n(8453);const l={sidebar_position:7},o="Ensambliado en l\xednea",d={},c=[{value:"Introducci\xf3n",id:"introducci\xf3n",level:2},{value:"Gram\xe1tica b\xe1sica",id:"gram\xe1tica-b\xe1sica",level:2},{value:"Ejemplo simple",id:"ejemplo-simple",level:2},{value:"Advertencias",id:"advertencias",level:2}];function t(e){const a={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"ensambliado-en-l\xednea",children:"Ensambliado en l\xednea"})}),"\n",(0,r.jsx)(a.h2,{id:"introducci\xf3n",children:"Introducci\xf3n"}),"\n",(0,r.jsx)(a.p,{children:"Este documento explica la funcionalidad de ensamblaje en l\xednea proporcionada por el lenguaje Wave.\nEl ensamblaje en l\xednea es una de las caracter\xedsticas proporcionadas por Wave, dise\xf1ada para permitir el acceso directo al control de hardware de bajo nivel mientras se mantiene la conveniencia y la estructura de un lenguaje de alto nivel."}),"\n",(0,r.jsx)(a.p,{children:"Permite realizar operaciones como la manipulaci\xf3n de registros, el acceso a direcciones de memoria y la ejecuci\xf3n de instrucciones espec\xedficas de la CPU que son dif\xedciles de expresar en c\xf3digo Wave ordinario, y se utiliza en situaciones donde la optimizaci\xf3n del rendimiento es importante o se necesita c\xf3digo fuertemente dependiente del hardware y la arquitectura.\nCon esta funcionalidad, Wave puede abarcar desde un simple lenguaje de alto nivel hasta el \xe1mbito de la programaci\xf3n de sistemas."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"gram\xe1tica-b\xe1sica",children:"Gram\xe1tica b\xe1sica"}),"\n",(0,r.jsxs)(a.p,{children:["El ensamblaje en l\xednea se escribe usando ",(0,r.jsx)(a.code,{children:"asm { ... }"})," como bloque.\nDentro de este bloque se definen tanto las instrucciones de ensamblaje que se van a ejecutar realmente como el mapeo de entrada y salida para conectar las variables Wave con los registros de la CPU."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-wave",children:'asm {\n    "Instrucci\xf3n ensambladora"          // C\xf3digo ensamblador real (una instrucci\xf3n por l\xednea)\n    ...\n    in("registro") valor         // Mapeo de registro de entrada\n    out("registro") variable      // Mapeo de registro de salida\n}\n'})}),"\n",(0,r.jsx)(a.p,{children:"Las instrucciones de ensamblaje se escriben en forma de cadena de caracteres, describiendo las instrucciones de bajo nivel que realmente se ejecutan en la CPU.\nPuede escribirse en m\xfaltiples l\xedneas y, en principio, solo debe haber un comando por l\xednea."}),"\n",(0,r.jsx)(a.p,{children:"Por ejemplo, se puede utilizar de la siguiente manera."}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-wave",children:'"mov rax, 1"\n"syscall"\n'})}),"\n",(0,r.jsxs)(a.p,{children:["La sintaxis ",(0,r.jsx)(a.code,{children:'in("registro")'})," se utiliza para cargar el valor de una variable o expresi\xf3n de Wave en un registro de CPU especificado.\nDe este modo, en el c\xf3digo ensamblador, se puede utilizar el registro como un valor de entrada."]}),"\n",(0,r.jsx)(a.p,{children:"El siguiente ejemplo ilustra el caso de pasar el valor de la variable s al registro rdi, que es el primer registro de argumento de syscall seg\xfan la convenci\xf3n x86-64."}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-wave",children:'in("rdi") s\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Por el contrario, la sintaxis de variable ",(0,r.jsx)(a.code,{children:'out("registro")'})," se usa para traer a una variable Wave el valor contenido en el registro especificado.\nEsta t\xe9cnica se utiliza cuando se necesita usar el resultado de la ejecuci\xf3n en ensamblador en el c\xf3digo Wave."]}),"\n",(0,r.jsxs)(a.p,{children:["El siguiente ejemplo describe el caso de almacenar en la variable ",(0,r.jsx)(a.code,{children:"ret"})," el valor del registro ",(0,r.jsx)(a.code,{children:"rax"})," donde se guarda el valor de retorno de la llamada a ",(0,r.jsx)(a.code,{children:"syscall"}),"."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-wave",children:'out("rax") ret\n'})}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"ejemplo-simple",children:"Ejemplo simple"}),"\n",(0,r.jsxs)(a.p,{children:["El siguiente ejemplo es un c\xf3digo sencillo que utiliza ",(0,r.jsx)(a.code,{children:"syscall"})," en un entorno Linux x86-64 para imprimir una cadena a la salida est\xe1ndar."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-wave",children:'fun main() {\n    var msg_ptr: ptr<i8> = "\xa1Hola desde syscall!\\n";\n    var ret_val: i64;\n\n    asm {\n        "mov rax, 1"\n        "syscall"\n        in("rdi") 1\n        in("rsi") msg_ptr\n        in("rdx") 20\n        out("rax") ret_val\n    }\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["En este ejemplo, el c\xf3digo Wave establece directamente en los registros el puntero y la longitud de la cadena, y realiza la operaci\xf3n de llamada al sistema para imprimir.\nEl valor de retorno de la llamada al sistema se transmite a trav\xe9s del registro ",(0,r.jsx)(a.code,{children:"rax"}),", y se recupera como variable Wave mediante la sintaxis ",(0,r.jsx)(a.code,{children:"out"}),"."]}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"advertencias",children:"Advertencias"}),"\n",(0,r.jsx)(a.p,{children:"El ensamblaje en l\xednea es una funci\xf3n que deliberadamente elude la seguridad de tipos y la abstracci\xf3n de Wave.\nSi se utilizan instrucciones incorrectas o hay errores en la configuraci\xf3n del registro, el programa puede terminar de manera anormal o presentar comportamiento indefinido."}),"\n",(0,r.jsxs)(a.p,{children:["El mapeo de registros mediante ",(0,r.jsx)(a.code,{children:"in"})," y ",(0,r.jsx)(a.code,{children:"out"})," se valida en tiempo de compilaci\xf3n, pero no se garantiza la validez sem\xe1ntica ni el resultado de ejecuci\xf3n de las instrucciones de ensamblado.\nPor lo tanto, al usar ensamblado en l\xednea, se debe comprender completamente la arquitectura objetivo, la convenci\xf3n de llamadas y el funcionamiento de las instrucciones."]})]})}function u(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453(e,a,n){n.d(a,{R:()=>l,x:()=>o});var i=n(6540);const r={},s=i.createContext(r);function l(e){const a=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:a},e.children)}}}]);